К сожалению, ничего не успел сделать, поэтому обьясню хотя бы основную идею того, как всё должно было бы работать

Т.к. у нас есть проблемы, которые можно было бы решать паралельно, я думал разделить каждый из следующих пунктов на отдельную задачу, которая бы решалась паралельно:
1) Узнать какой протокол используется - http/https/socks5
1.1) Если нет ответа ни на один из протоколов, то status = 'не работает'
2) Получить внешний IP
3) Получить страну и город по внешнему IP
4) Получить скорость загрузки

Причем первый пункт тоже можно было бы выполнить, разбив проверку каждого протокола на отдельную задачу.
Многие пункты зависят от предыдущих - их задачи можно создавать, когда кидается эвент об успешном выполнении предыдущего пункта.
Допустим, п.2 должен создаваться после успешного выполнения п.1

Для каждого типа задач мог бы быть свой worker, который берет пачку и обрабатывает их, кидая эвенты, которые подталкивали бы процесс.
Тут можно было бы подумать над Jobs-ами, но мне кажется, что когда задачи лежат в БД, можно было бы использовать батчи, к примеру с curl_multi_exec, ну и другие подобные оптимизации, которые сложны с Jobs.

Но сейчас, конечно, я понимаю, что не стоило замахиваться на такие грандиозные планы при ограничении в 8 часов.
